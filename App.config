<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <connectionStrings>
    <!--PROD-->
    <add name="AGDExcelReport" providerName="System.Data.SqlClient" connectionString="Data Source=13.67.51.170;Initial Catalog=PeppolAGD;User ID=spbts;Pwd=Sesami123;"/>
  <!--UAT-->
    <!--<add name="AGDExcelReport" providerName="System.Data.SqlClient" connectionString="Data Source=13.67.59.105;Initial Catalog=PeppolAGD;User ID=spbts;Pwd=Sesami123;"/>-->
    </connectionStrings>
  <appSettings>
    <!--PROD-->
    <!--<add key="Query1" value="SELECT distinct InvoiceHeader.DocumentID,InvoiceHeader.CreatedDate,InvoiceHeader.InvoiceStatus,InvoiceHeader.InterfaceStatus,InvoiceHeader.LastUpdDate as InterfaceDate,InvoiceHeader.BuyerReference as BusinessUnit, InvoiceHeader.InvoiceNo, InvoiceHeader.InvoiceIssueDate as InvoiceDate,InvoiceHeader.InvTypeCode as InvTypeCode,SupplierParty.LECompanyID as VendorID,OrderReference.ID as PONo,BillingReference.ID as RelatedInvoiceNo, InvoiceHeader.InvoiceCcy as CurrencyCode, AllowanceCharge.Amount as FreightAmount, TaxTotal.TaxAmount as VATAmount,LegalMonetaryTotal.TaxExclAmount as GrossAmountExcludesGST,CustomerParty.ContactName as AttentionTo,InvoiceHeader.InvoiceNote as Description,PaymentTerms.PaymentTermsNote as PaymentTerms,TaxSubTotal.TaxCatPercent as GSTPercentage,TaxSubTotal.TaxCatID as TaxCategoryID,SupplierParty.ContactMail as PEPPOLEmailAddress,PayeeParty.PartyID as FactoringId,InvoiceLine.ID as InvoiceLineNumber,InvoiceLine.PriceAmount as UnitPrice, InvoiceLine.InvoicedQuantity as InvoicedQuantity,InvoiceLine.LineExtnAmount as LineExtnAmount,InvoiceLine.Name as LineDescription,AdditionalDocumentReference.FileName as OriginalFileName,SBDHeader.SenderID as SenderIdentifier,SBDHeader.Sender as SenderAuthority,SupplierParty.PartyEndpointSID as SupplierPartyEndpointSchemeId,SupplierParty.PartyEndpointID as SupplierPartyEndpointId FROM [PeppolAGD].[dbo].[InvoiceHeader] InvoiceHeader         LEFT JOIN [PeppolAGD].[dbo].[SBDHeader] SBDHeader ON InvoiceHeader.DocumentID =SBDHeader.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[SupplierParty] SupplierParty ON InvoiceHeader.DocumentID =SupplierParty.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[OrderReference] OrderReference ON InvoiceHeader.DocumentID =OrderReference.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[BillingReference] BillingReference ON InvoiceHeader.DocumentID = BillingReference.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[AllowanceCharge] AllowanceCharge ON InvoiceHeader.DocumentID = AllowanceCharge.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[LegalMonetaryTotal] LegalMonetaryTotal ON InvoiceHeader.DocumentID = LegalMonetaryTotal.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[CustomerParty] CustomerParty ON InvoiceHeader.DocumentID = CustomerParty.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[PaymentTerms] PaymentTerms ON InvoiceHeader.DocumentID = PaymentTerms.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[PayeeParty] PayeeParty ON InvoiceHeader.DocumentID = PayeeParty.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[AdditionalDocumentReference] AdditionalDocumentReference ON InvoiceHeader.DocumentID = AdditionalDocumentReference.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[TaxTotal] TaxTotal ON InvoiceHeader.DocumentID = TaxTotal.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[TaxSubTotal] TaxSubTotal ON InvoiceHeader.DocumentID = TaxSubTotal.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[InvoiceLine] InvoiceLine ON InvoiceHeader.DocumentID = InvoiceLine.DocumentID           WHERE InvoiceStatus='GoodFile' and InterfaceStatus ='sent' and Receiver='SGUENT08GA0028A' and datediff(WEEK,InvoiceHeader.CreatedDate,getdate())=1 order by InvoiceHeader.CreatedDate,InvoiceHeader.DocumentID,InvoiceLine.ID"/>
    <add key="Query2" value="SELECT distinct InvoiceHeader.DocumentID,InvoiceHeader.CreatedDate,InvoiceHeader.InvoiceStatus,InvoiceHeader.InterfaceStatus,InvoiceHeader.LastUpdDate as InterfaceDate,InvoiceHeader.BuyerReference as BusinessUnit, InvoiceHeader.InvoiceNo, InvoiceHeader.InvoiceIssueDate as InvoiceDate,InvoiceHeader.InvTypeCode as InvTypeCode,SupplierParty.LECompanyID as VendorID,OrderReference.ID as PONo,BillingReference.ID as RelatedInvoiceNo, InvoiceHeader.InvoiceCcy as CurrencyCode, AllowanceCharge.Amount as FreightAmount, TaxTotal.TaxAmount as VATAmount,LegalMonetaryTotal.TaxExclAmount as GrossAmountExcludesGST,CustomerParty.ContactName as AttentionTo,InvoiceHeader.InvoiceNote as Description,PaymentTerms.PaymentTermsNote as PaymentTerms,TaxSubTotal.TaxCatPercent as GSTPercentage,TaxSubTotal.TaxCatID as TaxCategoryID,SupplierParty.ContactMail as PEPPOLEmailAddress,PayeeParty.PartyID as FactoringId,InvoiceLine.ID as InvoiceLineNumber,InvoiceLine.PriceAmount as UnitPrice, InvoiceLine.InvoicedQuantity as InvoicedQuantity,InvoiceLine.LineExtnAmount as LineExtnAmount,InvoiceLine.Name as LineDescription,AdditionalDocumentReference.FileName as OriginalFileName, BadFileHeader.ErrorMessage,SBDHeader.SenderID as SenderIdentifier,SBDHeader.Sender as SenderAuthority,SupplierParty.PartyEndpointSID as SupplierPartyEndpointSchemeId,SupplierParty.PartyEndpointID as SupplierPartyEndpointId FROM [PeppolAGD].[dbo].[InvoiceHeader] InvoiceHeader         LEFT JOIN [PeppolAGD].[dbo].[SBDHeader] SBDHeader ON InvoiceHeader.DocumentID =SBDHeader.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[SupplierParty] SupplierParty ON InvoiceHeader.DocumentID =SupplierParty.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[OrderReference] OrderReference ON InvoiceHeader.DocumentID =OrderReference.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[BillingReference] BillingReference ON InvoiceHeader.DocumentID = BillingReference.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[AllowanceCharge] AllowanceCharge ON InvoiceHeader.DocumentID = AllowanceCharge.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[LegalMonetaryTotal] LegalMonetaryTotal ON InvoiceHeader.DocumentID = LegalMonetaryTotal.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[CustomerParty] CustomerParty ON InvoiceHeader.DocumentID = CustomerParty.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[PaymentTerms] PaymentTerms ON InvoiceHeader.DocumentID = PaymentTerms.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[PayeeParty] PayeeParty ON InvoiceHeader.DocumentID = PayeeParty.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[AdditionalDocumentReference] AdditionalDocumentReference ON InvoiceHeader.DocumentID = AdditionalDocumentReference.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[TaxTotal] TaxTotal ON InvoiceHeader.DocumentID = TaxTotal.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[TaxSubTotal] TaxSubTotal ON InvoiceHeader.DocumentID = TaxSubTotal.DocumentID         LEFT JOIN [PeppolAGD].[dbo].[InvoiceLine] InvoiceLine ON InvoiceHeader.DocumentID = InvoiceLine.DocumentID           LEFT JOIN [PeppolAGD].[dbo].[BadFileHeader] BadFileHeader ON InvoiceHeader.DocumentID = BadFileHeader.DocumentID   WHERE InvoiceStatus='BadFile' and InterfaceStatus ='sent' and Receiver='SGUENT08GA0028A' and datediff(WEEK,InvoiceHeader.CreatedDate,getdate())=1 order by InvoiceHeader.CreatedDate,InvoiceHeader.DocumentID,InvoiceLine.ID"/>-->
    <add key="Query1" value="SELECT distinct InvoiceHeader.DocumentID,InvoiceHeader.CreatedDate,InvoiceHeader.InvoiceStatus,InvoiceHeader.InterfaceStatus,InvoiceHeader.LastUpdDate as InterfaceDate,InvoiceHeader.BuyerReference as BusinessUnit, InvoiceHeader.InvoiceNo, InvoiceHeader.InvoiceIssueDate as InvoiceDate,InvoiceHeader.InvTypeCode as InvTypeCode,SupplierParty.LECompanyID as VendorID,OrderReference.ID as PONo,BillingReference.ID as RelatedInvoiceNo, InvoiceHeader.InvoiceCcy as CurrencyCode,AllowanceCharge.Amount as FreightAmount,CONVERT(DECIMAL(12, 2),TaxTotal.TaxAmount) as VATAmount,CONVERT(DECIMAL(12, 2),LegalMonetaryTotal.TaxExclAmount) as GrossAmountExcludesGST,CustomerParty.ContactName as AttentionTo,InvoiceHeader.InvoiceNote as Description,PaymentTerms.PaymentTermsNote as PaymentTerms,CONVERT(DECIMAL(12, 2),TaxSubTotal.TaxCatPercent) as GSTPercentage,TaxSubTotal.TaxCatID as TaxCategoryID,SupplierParty.ContactMail as PEPPOLEmailAddress,PayeeParty.PartyID as FactoringId,InvoiceLine.ID as InvoiceLineNumber,InvoiceLine.LineID as InvoicePOLineNumber,CONVERT(DECIMAL(12, 2),InvoiceLine.PriceAmount) as UnitPrice,CONVERT(DECIMAL(12, 3),InvoiceLine.InvoicedQuantity) as InvoicedQuantity,CONVERT(DECIMAL(12, 2),InvoiceLine.LineExtnAmount) as LineExtnAmount,InvoiceLine.Name as LineDescription,AdditionalDocumentReference.FileName as OriginalFileName,SBDHeader.SenderID as SenderIdentifier,SBDHeader.Sender as SenderAuthority,SupplierParty.PartyEndpointSID as SupplierPartyEndpointSchemeId,SupplierParty.PartyEndpointID as SupplierPartyEndpointId,SBDHeader.ReceiverID as ReceiverIdentifier,SBDHeader.Receiver as ReceiverAuthority,CustomerParty.PartySchemeID as ReceiverPartyEndpointSchemeId,CustomerParty.PartyEndpointID as ReceiverPartyEndpointId FROM [PeppolAGD].[dbo].[InvoiceHeader] InvoiceHeader LEFT JOIN [PeppolAGD].[dbo].[SBDHeader] SBDHeader ON InvoiceHeader.DocumentID =SBDHeader.DocumentID LEFT JOIN [PeppolAGD].[dbo].[SupplierParty] SupplierParty ON InvoiceHeader.DocumentID =SupplierParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[OrderReference] OrderReference ON InvoiceHeader.DocumentID =OrderReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[BillingReference] BillingReference ON InvoiceHeader.DocumentID = BillingReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[AllowanceCharge] AllowanceCharge ON InvoiceHeader.DocumentID = AllowanceCharge.DocumentID LEFT JOIN [PeppolAGD].[dbo].[LegalMonetaryTotal] LegalMonetaryTotal ON InvoiceHeader.DocumentID = LegalMonetaryTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[CustomerParty] CustomerParty ON InvoiceHeader.DocumentID = CustomerParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[PaymentTerms] PaymentTerms ON InvoiceHeader.DocumentID = PaymentTerms.DocumentID LEFT JOIN [PeppolAGD].[dbo].[PayeeParty] PayeeParty ON InvoiceHeader.DocumentID = PayeeParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[AdditionalDocumentReference] AdditionalDocumentReference ON InvoiceHeader.DocumentID = AdditionalDocumentReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[TaxTotal] TaxTotal ON InvoiceHeader.DocumentID = TaxTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[TaxSubTotal] TaxSubTotal ON InvoiceHeader.DocumentID = TaxSubTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[InvoiceLine] InvoiceLine ON InvoiceHeader.DocumentID = InvoiceLine.DocumentID WHERE InvoiceStatus='GoodFile' and InterfaceStatus ='sent' and Receiver in ('SGUENT08GA0028A','SGUENT08GA0012J','SGUENT16GB0004K',	'SGUENT08GB0001G ','SGUENT08GB0002C ','SGUENT08GA0001H ','SGUENT08GA0002D ','SGUENT08GB0004F ','SGUENT08GB0005B ','SGUENT08GB0006J ','SGUENT08GA0031A ','SGUENT08GB0007E ','SGUENT08GB0008A ','SGUENT08GB0009H ','SGUENT08GB0010E ','SGUENT08GA0041F ','SGUENT09GA0001B ','SGUENT08GB0011A ','SGUENT08GA0040K ','SGUENT08GB0012H ','SGUENT08GA0042B ','SGUENT08GB0013D ','SGUENT08GB0014L ','SGUENT08GB0015G ','SGUENT08GA0032H ','SGUENT08GB0018F ','SGUENT08GA0033D ','SGUENT08GB0020K ','SGUENT08GB0022B ','SGUENT08GB0023J ','SGUENT08GB0021F ','SGUENT08GA0003L ','SGUENT08GA0005C ','SGUENT08GA0006K ','SGUENT08GB0027D ','SGUENT08GB0028L ','SGUENT08GA0017L ','SGUENT08GA0011B ','SGUENT08GA0013E ','SGUENT08GA0014A ','SGUENT08GA0015H ','SGUENT08GA0016D ','SGUENT08GA0018G ','SGUENT08GA0019C ','SGUENT08GA0020L ','SGUENT08GA0010F ','SGUENT08GA0021G ','SGUENT08GA0022C ','SGUENT08GA0023K ','SGUENT08GB0031L ','SGUENT08GB0032G ','SGUENT08GB0033C ','SGUENT08GB0034K ','SGUENT08GB0035F ','SGUENT08GB0036B ','SGUENT08GB0037J ','SGUENT08GB0038E ','SGUENT08GA0046H ','SGUENT08GA0047D ','SGUENT08GB0039A ','SGUENT08GA0007F ','SGUENT08GB0041E ','SGUENT08GA0024F ','SGUENT08GB0043H ','SGUENT08GA0048L ','SGUENT08GB0044D ','SGUENT08GB0045L ','SGUENT08GB0046G ','SGUENT08GB0047C ','SGUENT08GB0048K ','SGUENT08GA0035G ','SGUENT08GA0029H ','SGUENT08GB0050C ','SGUENT08GB0051K ','SGUENT08GB0052F ','SGUENT08GB0053B ','SGUENT08GB0054J ','SGUENT08GB0055E ','SGUENT08GB0065K ','SGUENT08GA0036C ','SGUENT08GB0056A ','SGUENT08GA0037K ','SGUENT08GB0057H ','SGUENT08GB0059L ','SGUENT08GB0062L ','SGUENT08GA0009J ','SGUENT08GB0058D ','SGUENT08GB0063G ','SGUENT08GB0064C ','SGUENT08GA0030E ','SGUENT08GB0060H ','SGUENT08GB0049F ','SGUENT04CC1808H ','SGUENT10GA0001D ','SGUENT14GA0001B ','SGUENT15GA0001G ','SGUENT15GA0002C ','SGUENT17GA0001F ','SGUENT10GB0001C ','SGUENT10GB0002K ','SGUENT16GB0002G ','SGUENT16GB0003C ','SGUENT18GB0001K','SGUENT07GS1744L','SGUENT07GS3072B','SGUENT07GS1738A','SGUENT07GS3201H','SGUENT07GS5625C','SGUENT13GS0002K','SGUENT07GS1254F','SGUENT07GS1766B','SGUENT07GS3001D','SGUENT18GS0002B','SGUENT07GS1150J','SGUENT07GS3026E','SGUENT07GS7101C','SGUENT07GS0803F','SGUENT07GS7032A','SGUENT07GS5001H','SGUENT07GS5638G','SGUENT14GS0006K','SGUENT07GS7002H','SGUENT07GS3002L','SGUENT07GS1249C','SGUENT07GS3003G','SGUENT07GS1230A','SGUENT07GS3069B','SGUENT07GS3027A','SGUENT07GS3225B','SGUENT07GS1129B','SGUENT07GS3021C','SGUENT07GS1145F','SGUENT07GS1640C','SGUENT07GS3224F','SGUENT07GS3043E','SGUENT07GS3202D','SGUENT07GS3044A','SGUENT07GS3203L','SGUENT07GS3204G','SGUENT07GS1020C','SGUENT07GS1247L','SGUENT07GS1209E','SGUENT07GS3040F','SGUENT07GS1751F','SGUENT07GS3621D','SGUENT18GS0005A','SGUENT10GS0001K','SGUENT07GS1771E','SGUENT07GS7102K','SGUENT07GS0802K','SGUENT07GS3004C','SGUENT07GS1211J','SGUENT07GS3402H','SGUENT07GS1239J','SGUENT07GS5637L','SGUENT07GS5005C','SGUENT07GS5019C','SGUENT07GS7008F','SGUENT07GS5017L','SGUENT07GS5007F','SGUENT07GS5004G','SGUENT07GS7004L','SGUENT07GS7019G','SGUENT07GS7118B','SGUENT07GS7023C','SGUENT07GS5636D','SGUENT07GS1203G','SGUENT07GS7025F','SGUENT07GS1244A','SGUENT07GS3055B','SGUENT07GS7104B','SGUENT07GS7105J','SGUENT07GS1772A','SGUENT07GS3029D','SGUENT07GS3012E','SGUENT07GS1757D','SGUENT07GS3622L','SGUENT07GS1760D','SGUENT07GS1132B','SGUENT07GS3005K','SGUENT07GS1102J','SGUENT07GS3056J','SGUENT07GS1229D','SGUENT07GS5008B','SGUENT07GS3228A','SGUENT07GS3503F','SGUENT07GS3101F','SGUENT07GS3207F','SGUENT07GS1755A','SGUENT07GS3609F','SGUENT07GS1769A','SGUENT18GB0002F','SGUENT19GA0001E','SGUENT12GA0001C','SGUENT19GB0001D','SGUENT08CC3006B','SGUEN199503187D','SGUEN199303325G','SGUEN199702110H','SGUEN201628172W') and InvoiceHeader.CreatedDate &gt;= DATEADD(wk, DATEDIFF(wk, 6, GETDATE()), 0) AND InvoiceHeader.CreatedDate &lt;=  DATEADD(wk, DATEDIFF(wk, 6, GETDATE()), 7) order by InvoiceHeader.CreatedDate,InvoiceHeader.DocumentID,InvoiceLine.ID"/>
    <add key="Query2" value="SELECT distinct InvoiceHeader.DocumentID,InvoiceHeader.CreatedDate,InvoiceHeader.InvoiceStatus,InvoiceHeader.InterfaceStatus,InvoiceHeader.LastUpdDate as InterfaceDate,InvoiceHeader.BuyerReference as BusinessUnit, InvoiceHeader.InvoiceNo, InvoiceHeader.InvoiceIssueDate as InvoiceDate,InvoiceHeader.InvTypeCode as InvTypeCode,SupplierParty.LECompanyID as VendorID,OrderReference.ID as PONo,BillingReference.ID as RelatedInvoiceNo, InvoiceHeader.InvoiceCcy as CurrencyCode,AllowanceCharge.Amount as FreightAmount, CONVERT(DECIMAL(12, 2),TaxTotal.TaxAmount) as VATAmount,CONVERT(DECIMAL(12, 2),LegalMonetaryTotal.TaxExclAmount) as GrossAmountExcludesGST,CustomerParty.ContactName as AttentionTo,InvoiceHeader.InvoiceNote as Description, PaymentTerms.PaymentTermsNote as PaymentTerms,CONVERT(DECIMAL(12, 2),TaxSubTotal.TaxCatPercent) as GSTPercentage,TaxSubTotal.TaxCatID as TaxCategoryID,SupplierParty.ContactMail as PEPPOLEmailAddress, PayeeParty.PartyID as FactoringId,InvoiceLine.ID as InvoiceLineNumber,InvoiceLine.LineID as InvoicePOLineNumber,CONVERT(DECIMAL(12, 2),InvoiceLine.PriceAmount) as UnitPrice,CONVERT(DECIMAL(12, 3),InvoiceLine.InvoicedQuantity) as InvoicedQuantity, CONVERT(DECIMAL(12, 2),InvoiceLine.LineExtnAmount) as LineExtnAmount,InvoiceLine.Name as LineDescription,AdditionalDocumentReference.FileName as OriginalFileName,BadFileHeader.ErrorMessage, SBDHeader.SenderID as SenderIdentifier,SBDHeader.Sender as SenderAuthority,SupplierParty.PartyEndpointSID as SupplierPartyEndpointSchemeId,SupplierParty.PartyEndpointID as SupplierPartyEndpointId, SBDHeader.ReceiverID as ReceiverIdentifier,SBDHeader.Receiver as ReceiverAuthority,CustomerParty.PartySchemeID as ReceiverPartyEndpointSchemeId,CustomerParty.PartyEndpointID as ReceiverPartyEndpointId FROM [PeppolAGD].[dbo].[InvoiceHeader] InvoiceHeader LEFT JOIN [PeppolAGD].[dbo].[SBDHeader] SBDHeader ON InvoiceHeader.DocumentID =SBDHeader.DocumentID LEFT JOIN [PeppolAGD].[dbo].[SupplierParty] SupplierParty ON InvoiceHeader.DocumentID =SupplierParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[OrderReference] OrderReference ON InvoiceHeader.DocumentID =OrderReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[BillingReference] BillingReference ON InvoiceHeader.DocumentID = BillingReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[AllowanceCharge] AllowanceCharge ON InvoiceHeader.DocumentID = AllowanceCharge.DocumentID LEFT JOIN [PeppolAGD].[dbo].[LegalMonetaryTotal] LegalMonetaryTotal ON InvoiceHeader.DocumentID = LegalMonetaryTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[CustomerParty] CustomerParty ON InvoiceHeader.DocumentID = CustomerParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[PaymentTerms] PaymentTerms ON InvoiceHeader.DocumentID = PaymentTerms.DocumentID LEFT JOIN [PeppolAGD].[dbo].[PayeeParty] PayeeParty ON InvoiceHeader.DocumentID = PayeeParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[AdditionalDocumentReference] AdditionalDocumentReference ON InvoiceHeader.DocumentID = AdditionalDocumentReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[TaxTotal] TaxTotal ON InvoiceHeader.DocumentID = TaxTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[TaxSubTotal] TaxSubTotal ON InvoiceHeader.DocumentID = TaxSubTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[InvoiceLine] InvoiceLine ON InvoiceHeader.DocumentID = InvoiceLine.DocumentID LEFT JOIN [PeppolAGD].[dbo].[BadFileHeader] BadFileHeader ON InvoiceHeader.DocumentID = BadFileHeader.DocumentID   WHERE InvoiceStatus='BadFile' and InterfaceStatus ='sent' and Receiver in ('SGUENT08GA0028A','SGUENT08GA0012J','SGUENT16GB0004K',	'SGUENT08GB0001G ','SGUENT08GB0002C ','SGUENT08GA0001H ','SGUENT08GA0002D ','SGUENT08GB0004F ','SGUENT08GB0005B ','SGUENT08GB0006J ','SGUENT08GA0031A ','SGUENT08GB0007E ','SGUENT08GB0008A ','SGUENT08GB0009H ','SGUENT08GB0010E ','SGUENT08GA0041F ','SGUENT09GA0001B ','SGUENT08GB0011A ','SGUENT08GA0040K ','SGUENT08GB0012H ','SGUENT08GA0042B ','SGUENT08GB0013D ','SGUENT08GB0014L ','SGUENT08GB0015G ','SGUENT08GA0032H ','SGUENT08GB0018F ','SGUENT08GA0033D ','SGUENT08GB0020K ','SGUENT08GB0022B ','SGUENT08GB0023J ','SGUENT08GB0021F ','SGUENT08GA0003L ','SGUENT08GA0005C ','SGUENT08GA0006K ','SGUENT08GB0027D ','SGUENT08GB0028L ','SGUENT08GA0017L ','SGUENT08GA0011B ','SGUENT08GA0013E ','SGUENT08GA0014A ','SGUENT08GA0015H ','SGUENT08GA0016D ','SGUENT08GA0018G ','SGUENT08GA0019C ','SGUENT08GA0020L ','SGUENT08GA0010F ','SGUENT08GA0021G ','SGUENT08GA0022C ','SGUENT08GA0023K ','SGUENT08GB0031L ','SGUENT08GB0032G ','SGUENT08GB0033C ','SGUENT08GB0034K ','SGUENT08GB0035F ','SGUENT08GB0036B ','SGUENT08GB0037J ','SGUENT08GB0038E ','SGUENT08GA0046H ','SGUENT08GA0047D ','SGUENT08GB0039A ','SGUENT08GA0007F ','SGUENT08GB0041E ','SGUENT08GA0024F ','SGUENT08GB0043H ','SGUENT08GA0048L ','SGUENT08GB0044D ','SGUENT08GB0045L ','SGUENT08GB0046G ','SGUENT08GB0047C ','SGUENT08GB0048K ','SGUENT08GA0035G ','SGUENT08GA0029H ','SGUENT08GB0050C ','SGUENT08GB0051K ','SGUENT08GB0052F ','SGUENT08GB0053B ','SGUENT08GB0054J ','SGUENT08GB0055E ','SGUENT08GB0065K ','SGUENT08GA0036C ','SGUENT08GB0056A ','SGUENT08GA0037K ','SGUENT08GB0057H ','SGUENT08GB0059L ','SGUENT08GB0062L ','SGUENT08GA0009J ','SGUENT08GB0058D ','SGUENT08GB0063G ','SGUENT08GB0064C ','SGUENT08GA0030E ','SGUENT08GB0060H ','SGUENT08GB0049F ','SGUENT04CC1808H ','SGUENT10GA0001D ','SGUENT14GA0001B ','SGUENT15GA0001G ','SGUENT15GA0002C ','SGUENT17GA0001F ','SGUENT10GB0001C ','SGUENT10GB0002K ','SGUENT16GB0002G ','SGUENT16GB0003C ','SGUENT18GB0001K','SGUENT07GS1744L','SGUENT07GS3072B','SGUENT07GS1738A','SGUENT07GS3201H','SGUENT07GS5625C','SGUENT13GS0002K','SGUENT07GS1254F','SGUENT07GS1766B','SGUENT07GS3001D','SGUENT18GS0002B','SGUENT07GS1150J','SGUENT07GS3026E','SGUENT07GS7101C','SGUENT07GS0803F','SGUENT07GS7032A','SGUENT07GS5001H','SGUENT07GS5638G','SGUENT14GS0006K','SGUENT07GS7002H','SGUENT07GS3002L','SGUENT07GS1249C','SGUENT07GS3003G','SGUENT07GS1230A','SGUENT07GS3069B','SGUENT07GS3027A','SGUENT07GS3225B','SGUENT07GS1129B','SGUENT07GS3021C','SGUENT07GS1145F','SGUENT07GS1640C','SGUENT07GS3224F','SGUENT07GS3043E','SGUENT07GS3202D','SGUENT07GS3044A','SGUENT07GS3203L','SGUENT07GS3204G','SGUENT07GS1020C','SGUENT07GS1247L','SGUENT07GS1209E','SGUENT07GS3040F','SGUENT07GS1751F','SGUENT07GS3621D','SGUENT18GS0005A','SGUENT10GS0001K','SGUENT07GS1771E','SGUENT07GS7102K','SGUENT07GS0802K','SGUENT07GS3004C','SGUENT07GS1211J','SGUENT07GS3402H','SGUENT07GS1239J','SGUENT07GS5637L','SGUENT07GS5005C','SGUENT07GS5019C','SGUENT07GS7008F','SGUENT07GS5017L','SGUENT07GS5007F','SGUENT07GS5004G','SGUENT07GS7004L','SGUENT07GS7019G','SGUENT07GS7118B','SGUENT07GS7023C','SGUENT07GS5636D','SGUENT07GS1203G','SGUENT07GS7025F','SGUENT07GS1244A','SGUENT07GS3055B','SGUENT07GS7104B','SGUENT07GS7105J','SGUENT07GS1772A','SGUENT07GS3029D','SGUENT07GS3012E','SGUENT07GS1757D','SGUENT07GS3622L','SGUENT07GS1760D','SGUENT07GS1132B','SGUENT07GS3005K','SGUENT07GS1102J','SGUENT07GS3056J','SGUENT07GS1229D','SGUENT07GS5008B','SGUENT07GS3228A','SGUENT07GS3503F','SGUENT07GS3101F','SGUENT07GS3207F','SGUENT07GS1755A','SGUENT07GS3609F','SGUENT07GS1769A','SGUENT18GB0002F','SGUENT19GA0001E','SGUENT12GA0001C','SGUENT19GB0001D','SGUENT08CC3006B','SGUEN199503187D','SGUEN199303325G','SGUEN199702110H','SGUEN201628172W') and InvoiceHeader.CreatedDate &gt;= DATEADD(wk, DATEDIFF(wk, 6, GETDATE()), 0) AND InvoiceHeader.CreatedDate &lt;=  DATEADD(wk, DATEDIFF(wk, 6, GETDATE()), 7) order by InvoiceHeader.CreatedDate,InvoiceHeader.DocumentID,InvoiceLine.ID"/>
    <!--UAT-->
    <!--<add key="Query1" value="SELECT distinct InvoiceHeader.DocumentID,InvoiceHeader.CreatedDate,InvoiceHeader.InvoiceStatus,InvoiceHeader.InterfaceStatus,InvoiceHeader.LastUpdDate as InterfaceDate,InvoiceHeader.BuyerReference as BusinessUnit, InvoiceHeader.InvoiceNo, InvoiceHeader.InvoiceIssueDate as InvoiceDate,InvoiceHeader.InvTypeCode as InvTypeCode,SupplierParty.LECompanyID as VendorID,OrderReference.ID as PONo,BillingReference.ID as RelatedInvoiceNo, InvoiceHeader.InvoiceCcy as CurrencyCode,AllowanceCharge.Amount as FreightAmount, TaxTotal.TaxAmount as VATAmount,LegalMonetaryTotal.TaxExclAmount as GrossAmountExcludesGST,CustomerParty.ContactName as AttentionTo,InvoiceHeader.InvoiceNote as Description,PaymentTerms.PaymentTermsNote as PaymentTerms,TaxSubTotal.TaxCatPercent as GSTPercentage,TaxSubTotal.TaxCatID as TaxCategoryID,SupplierParty.ContactMail as PEPPOLEmailAddress,PayeeParty.PartyID as FactoringId,InvoiceLine.ID as InvoiceLineNumber,InvoiceLine.LineID as InvoicePOLineNumber,InvoiceLine.PriceAmount as UnitPrice,InvoiceLine.InvoicedQuantity as InvoicedQuantity,InvoiceLine.LineExtnAmount as LineExtnAmount,InvoiceLine.Name as LineDescription,AdditionalDocumentReference.FileName as OriginalFileName,SBDHeader.SenderID as SenderIdentifier,SBDHeader.Sender as SenderAuthority,SupplierParty.PartyEndpointSID as SupplierPartyEndpointSchemeId,SupplierParty.PartyEndpointID as SupplierPartyEndpointId,SBDHeader.ReceiverID as ReceiverIdentifier,SBDHeader.Receiver as ReceiverAuthority,CustomerParty.PartySchemeID as ReceiverPartyEndpointSchemeId,CustomerParty.PartyEndpointID as ReceiverPartyEndpointId FROM [PeppolAGD].[dbo].[InvoiceHeader] InvoiceHeader LEFT JOIN [PeppolAGD].[dbo].[SBDHeader] SBDHeader ON InvoiceHeader.DocumentID =SBDHeader.DocumentID LEFT JOIN [PeppolAGD].[dbo].[SupplierParty] SupplierParty ON InvoiceHeader.DocumentID =SupplierParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[OrderReference] OrderReference ON InvoiceHeader.DocumentID =OrderReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[BillingReference] BillingReference ON InvoiceHeader.DocumentID = BillingReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[AllowanceCharge] AllowanceCharge ON InvoiceHeader.DocumentID = AllowanceCharge.DocumentID LEFT JOIN [PeppolAGD].[dbo].[LegalMonetaryTotal] LegalMonetaryTotal ON InvoiceHeader.DocumentID = LegalMonetaryTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[CustomerParty] CustomerParty ON InvoiceHeader.DocumentID = CustomerParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[PaymentTerms] PaymentTerms ON InvoiceHeader.DocumentID = PaymentTerms.DocumentID LEFT JOIN [PeppolAGD].[dbo].[PayeeParty] PayeeParty ON InvoiceHeader.DocumentID = PayeeParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[AdditionalDocumentReference] AdditionalDocumentReference ON InvoiceHeader.DocumentID = AdditionalDocumentReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[TaxTotal] TaxTotal ON InvoiceHeader.DocumentID = TaxTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[TaxSubTotal] TaxSubTotal ON InvoiceHeader.DocumentID = TaxSubTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[InvoiceLine] InvoiceLine ON InvoiceHeader.DocumentID = InvoiceLine.DocumentID WHERE InvoiceStatus='GoodFile' and InterfaceStatus ='sent' and Receiver in ('SGTSTT08GA0028A','SGTSTT16GB0004K','SGTSTT08GA0012J') and InvoiceHeader.CreatedDate &gt;= DATEADD(wk, DATEDIFF(wk, 6, GETDATE()), 0) AND InvoiceHeader.CreatedDate &lt;=  DATEADD(wk, DATEDIFF(wk, 6, GETDATE()), 7) order by InvoiceHeader.CreatedDate,InvoiceHeader.DocumentID,InvoiceLine.ID"/>
    <add key="Query2" value="SELECT distinct InvoiceHeader.DocumentID,InvoiceHeader.CreatedDate,InvoiceHeader.InvoiceStatus,InvoiceHeader.InterfaceStatus,InvoiceHeader.LastUpdDate as InterfaceDate,InvoiceHeader.BuyerReference as BusinessUnit, InvoiceHeader.InvoiceNo, InvoiceHeader.InvoiceIssueDate as InvoiceDate,InvoiceHeader.InvTypeCode as InvTypeCode,SupplierParty.LECompanyID as VendorID,OrderReference.ID as PONo,BillingReference.ID as RelatedInvoiceNo, InvoiceHeader.InvoiceCcy as CurrencyCode,AllowanceCharge.Amount as FreightAmount, TaxTotal.TaxAmount as VATAmount,LegalMonetaryTotal.TaxExclAmount as GrossAmountExcludesGST,CustomerParty.ContactName as AttentionTo,InvoiceHeader.InvoiceNote as Description,PaymentTerms.PaymentTermsNote as PaymentTerms,TaxSubTotal.TaxCatPercent as GSTPercentage,TaxSubTotal.TaxCatID as TaxCategoryID,SupplierParty.ContactMail as PEPPOLEmailAddress,PayeeParty.PartyID as FactoringId,InvoiceLine.ID as InvoiceLineNumber,InvoiceLine.LineID as InvoicePOLineNumber,InvoiceLine.PriceAmount as UnitPrice,InvoiceLine.InvoicedQuantity as InvoicedQuantity,InvoiceLine.LineExtnAmount as LineExtnAmount,InvoiceLine.Name as LineDescription,AdditionalDocumentReference.FileName as OriginalFileName,BadFileHeader.ErrorMessage,SBDHeader.SenderID as SenderIdentifier,SBDHeader.Sender as SenderAuthority,SupplierParty.PartyEndpointSID as SupplierPartyEndpointSchemeId,SupplierParty.PartyEndpointID as SupplierPartyEndpointId,SBDHeader.ReceiverID as ReceiverIdentifier,SBDHeader.Receiver as ReceiverAuthority,CustomerParty.PartySchemeID as ReceiverPartyEndpointSchemeId,CustomerParty.PartyEndpointID as ReceiverPartyEndpointId FROM [PeppolAGD].[dbo].[InvoiceHeader] InvoiceHeader LEFT JOIN [PeppolAGD].[dbo].[SBDHeader] SBDHeader ON InvoiceHeader.DocumentID =SBDHeader.DocumentID LEFT JOIN [PeppolAGD].[dbo].[SupplierParty] SupplierParty ON InvoiceHeader.DocumentID =SupplierParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[OrderReference] OrderReference ON InvoiceHeader.DocumentID =OrderReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[BillingReference] BillingReference ON InvoiceHeader.DocumentID = BillingReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[AllowanceCharge] AllowanceCharge ON InvoiceHeader.DocumentID = AllowanceCharge.DocumentID LEFT JOIN [PeppolAGD].[dbo].[LegalMonetaryTotal] LegalMonetaryTotal ON InvoiceHeader.DocumentID = LegalMonetaryTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[CustomerParty] CustomerParty ON InvoiceHeader.DocumentID = CustomerParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[PaymentTerms] PaymentTerms ON InvoiceHeader.DocumentID = PaymentTerms.DocumentID LEFT JOIN [PeppolAGD].[dbo].[PayeeParty] PayeeParty ON InvoiceHeader.DocumentID = PayeeParty.DocumentID LEFT JOIN [PeppolAGD].[dbo].[AdditionalDocumentReference] AdditionalDocumentReference ON InvoiceHeader.DocumentID = AdditionalDocumentReference.DocumentID LEFT JOIN [PeppolAGD].[dbo].[TaxTotal] TaxTotal ON InvoiceHeader.DocumentID = TaxTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[TaxSubTotal] TaxSubTotal ON InvoiceHeader.DocumentID = TaxSubTotal.DocumentID LEFT JOIN [PeppolAGD].[dbo].[InvoiceLine] InvoiceLine ON InvoiceHeader.DocumentID = InvoiceLine.DocumentID LEFT JOIN [PeppolAGD].[dbo].[BadFileHeader] BadFileHeader ON InvoiceHeader.DocumentID = BadFileHeader.DocumentID   WHERE InvoiceStatus='BadFile' and InterfaceStatus ='sent' and Receiver in ('SGTSTT08GA0028A','SGTSTT16GB0004K','SGTSTT08GA0012J') and InvoiceHeader.CreatedDate &gt;= DATEADD(wk, DATEDIFF(wk, 6, GETDATE()), 0) AND InvoiceHeader.CreatedDate &lt;=  DATEADD(wk, DATEDIFF(wk, 6, GETDATE()), 7) order by InvoiceHeader.CreatedDate,InvoiceHeader.DocumentID,InvoiceLine.ID"/>-->
    <add key="ServerHost" value="192.168.193.29"/>
    <add key="MailFrom" value="lakshman@sesami.com"/>
    <add key="MailCc" value="surendar@sesami.com"/>
    <add key="MailTo" value="lakshman@sesami.com,surendar@sesami.com"/>
    <add key="MailFrom" value="lakshman@sesami.com"/>
    
  </appSettings>  
  <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6"/>
    </startup>
</configuration>
